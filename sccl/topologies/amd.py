# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

from .topology import Topology

def amd4():
    links = [
        [0, 1, 1, 0],
        [1, 0, 0, 1],
        [1, 0, 0, 1],
        [0, 1, 1, 0]
    ]
    return Topology('AMD4', links)

def amd8():
    links = [
        [0, 5, 6, 6, 5, 6, 5, 5],
        [5, 0, 5, 5, 6, 5, 6, 6],
        [6, 5, 0, 6, 5, 6, 5, 5],
        [6, 5, 6, 0, 5, 6, 5, 5],
        [5, 6, 5, 5, 0, 5, 6, 6],
        [6, 5, 6, 6, 5, 0, 5, 5],
        [5, 6, 5, 5, 6, 5, 0, 6],
        [5, 6, 5, 5, 6, 5, 6, 0]
    ]
    return Topology('AMD8', links)

def amdnew():
    links = [
        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
    ]
    rings = [
        #red
        [0,15,14,12,13,11,10,8,9,6,7,5,4,2,3,1,0],
        #green
        [0,1,14,15,13,12,10,11,9,8,7,6,4,5,3,2,0],
        #blue
        [0,1,15,14,12,13,5,4,6,7,9,8,10,11,3,2,0],
    ]
    for ring in rings:
        prev = None
        for rank in ring:
            if not prev is None:
                links[prev][rank] += 1
                links[rank][prev] += 1
            prev = rank
    return Topology('AMDnew', links)